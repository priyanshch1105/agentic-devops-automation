# Agentic DevOps / Cloud Automation Assistant

An **agentic, safe-by-default DevOps assistant** that converts natural language into Terraform plans, runs them in a Docker sandbox, enforces OPA policies, audits AWS (read-only), estimates costs, and generates CI/CD pipelines â€” **without ever applying infrastructure automatically**.

---

## âœ¨ Features

* Natural Language â†’ Terraform (AWS)
* Docker-based Terraform sandbox (`plan` only)
* AWS AssumeRole (read-only, no static keys)
* OPA policy enforcement on Terraform plans
* Cloud cost audit (AWS Cost Explorer)
* CI/CD pipeline generator (GitHub Actions)
* CLI + FastAPI API
* LangGraph-based agent orchestration
* Human-in-the-loop approval model

---

## ğŸ” Safety Guarantees (Non-Negotiable)

* âŒ No `terraform apply`
* âŒ No host execution of Terraform
* âŒ No static AWS credentials
* âœ… Docker isolation
* âœ… Read-only IAM role
* âœ… Policy-as-code (OPA)
* âœ… Manual approval before prod

---

## ğŸ—ï¸ Architecture

```
User (CLI / API)
      â†“
FastAPI
      â†“
LangGraph Orchestrator
      â†“
Planner â†’ IaC â†’ Terraform Plan (Docker)
      â†“
OPA Policy Check
      â†“
AWS Audit + Cost Agent
      â†“
CI/CD Generator
      â†“
Human Approval
```

---

## ğŸ“ Project Structure

```
agentic-devops/
â”œâ”€â”€ api/                # FastAPI routes
â”œâ”€â”€ agents/             # Planner, IaC, Audit, CI/CD agents
â”œâ”€â”€ executor/           # Docker + Terraform + AWS AssumeRole
â”œâ”€â”€ infra/runtime/      # Generated Terraform files
â”œâ”€â”€ policies/           # OPA Rego policies
â”œâ”€â”€ cli/                # Developer CLI
â”œâ”€â”€ docker/             # Terraform sandbox image
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

## âš™ï¸ Prerequisites

System dependencies (must be installed):

* Docker
* Terraform
* OPA CLI
* Ollama (local LLM)
* AWS CLI (for bootstrap auth)

Python:

* Python 3.11+

---

## ğŸ¤– Ollama Setup (LLM)

```bash
ollama serve
ollama pull qwen2.5
```

Used via `langchain-community` â†’ `ChatOllama`.

---

## ğŸ³ Terraform Docker Sandbox

Build once from project root:

```bash
docker build -t tf-sandbox -f docker/terraform.Dockerfile .
```

Verify:

```bash
docker run --rm tf-sandbox version
```

---

## ğŸ”‘ AWS Read-Only Access

Create an IAM role with **ReadOnlyAccess**
Use **STS AssumeRole** only (no static keys).

Required permissions include:

* `ec2:Describe*`
* `eks:Describe*`
* `iam:Get*`
* `cloudwatch:Get*`
* `ce:GetCostAndUsage`

---

## â–¶ï¸ Run the API

```bash
uvicorn api.main:app --reload
```

Test:

```http
POST /generate
{
  "prompt": "Create a scalable AWS backend in ap-south-1"
}
```

---

## ğŸ§‘â€ğŸ’» CLI Usage

```bash
python cli/main.py generate "Create AWS EKS cluster"
```

Returns:

* Terraform plan output
* Policy violations (if any)
* Cost estimate
* CI/CD pipeline YAML

---

## ğŸ§ª What the System Does NOT Do

* âŒ Apply Terraform
* âŒ Modify AWS resources
* âŒ Bypass policies
* âŒ Run with admin IAM

This is intentional.

---
## ğŸ”§ About `infra/runtime` (Important)

`infra/runtime` is **not an environment**.

It is a **temporary execution sandbox** managed entirely by the platform.

### What this means

* Users **never edit** `infra/runtime`
* Users **never commit** `infra/runtime`
* All Terraform plans and applies run **inside `runtime`**
* Environment safety is enforced by **policies, approvals, and GitHub protections**, not folder names

### Where users work

Users define intent in:

```
infra/dev
infra/staging
infra/prod
```

The platform automatically:

```
infra/{environment} â†’ infra/runtime â†’ plan / policy / approval / apply
```

### Why this design

* Prevents accidental production changes
* Guarantees consistent execution
* Enables policy enforcement and audit trails
* Separates **intent** from **execution**

> **Think of `runtime` as a secure execution engine â€” not a workspace.**

âš ï¸ Do not edit or commit files inside `infra/runtime`.


---
## ğŸ›£ï¸ Roadmap

* Kubernetes runtime agent
* GitHub PR auto-generation
* Multi-cloud (GCP / Azure)
* Incident response agent
* SaaS dashboard

---

## ğŸ§  Philosophy

> â€œInfra automation should be **agentic**, but never **autonomous without consent**.â€

This project prioritizes **trust, safety, and production realism**.

---

## ğŸ“œ License

MIT License
